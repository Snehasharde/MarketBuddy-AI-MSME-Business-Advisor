<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>User Profile</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
		:root {
		  --accent: #2dd4bf;
		  --dark: #fff;
		}
		body {
		  background: linear-gradient(180deg, #121d25 0%, #121d25 100%);
		  font-family: 'Segoe UI', sans-serif;
		  padding: 1rem;
		  margin: 0;
		  padding: 0;
		}
        .profile-container {
            max-width: 800px;
            margin: 40px auto;
            background: #0f172a;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }
        .profile-image-wrapper {
            position: relative;
            display: inline-block;
        }
        .profile-image {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid #fff;
        }
        .upload-icon {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: #fff;
            color: black;
            border-radius: 50%;
            padding: 6px;
            cursor: pointer;
            font-size: 18px;
            border: 2px solid #fff;
        }
        .form-label {
            font-weight: 600;
        }
        .btn-custom {
            border-radius: 8px;
            padding: 10px 20px;
        }
            /********************************/
			@media screen and (max-width: 480px) {
			        .content {
			            padding: 0 10px;
						
			        }
			        nav a.button {
			            text-align: center;
			        }
			    }
			    nav a.button {
			            border: 1px solid #19191a;
			            padding: 5px 15px;
			            border-radius: 20px;
			        }
			        section.hero {
			            text-align: center;
			            background: url('https://via.placeholder.com/1366x300') no-repeat center/cover;
			            color: white;
			            padding: 100px 20px 50px;
			            font-size: 32px;
			            font-weight: bold;
			        }
			        .navbar {
			  display: flex;
			  justify-content: space-between;
			  align-items: center;
			  padding: 1rem 2rem;
			  background: linear-gradient(90deg, #1f1c2c, #928dab);
			  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
			  font-family: 'Segoe UI', sans-serif;
			}

			.logo {
			  color: #fff;
			  font-size: 1.8rem;
			  font-weight: bold;
			  letter-spacing: 1px;
			}

			.nav-links {
			  list-style: none;
			  display: flex;
			  gap: 2rem;
			}

			.nav-links a {
			  position: relative;
			  color: #ffffff;
			  text-decoration: none;
			  font-size: 1rem;
			  padding-bottom: 5px;
			  transition: color 0.3s ease;
			}

			/* Underline animation (will be colored dynamically) */
			.nav-links a::after {
			  content: '';
			  position: absolute;
			  width: 0%;
			  height: 3px;
			  left: 0;
			  bottom: 0;
			  background-color: currentColor; /* Will be updated with JS */
			  transition: width 0.3s ease-in-out;
			  border-radius: 2px;
			}

			.nav-links a.active::after {
			  width: 100%;
			}

			.nav-links a.active {
			  color: var(--active-color); /* This will be set via JS */
			}

    </style>
</head>
<body>
	
	<nav class="navbar">
	  <div class="logo">MarketBuddy</div>
	  <ul class="nav-links">
	    <li><a th:href="@{/index}" class="active" data-color="#ffcc00">Home</a></li>
	    <li><a th:href="@{/features}" data-color="#00c2cb">Features</a></li>
	    <li><a th:href="@{/about}" data-color="#ff6f61">Our firm</a></li>
	    <li><a th:href="@{/blog}" data-color="#82e0aa">Blogs</a></li>
	    <li><a th:href="@{/resourceC}" data-color="#82e0aa">Resource Center</a></li>
	    <li><a th:href="@{/login}" class="button">Logins</a></li>
		<!-- Profile Icon Link -->
		<li><a th:href="@{/profile}" target="_blank" class="profile-icon">
		  <i class="fa-solid fa-user"></i></a></li>
	  </ul>
	</nav>
	
<div class="container">
    <div class="profile-container">
        <!-- Header with Logout -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="text-primary">User Profile</h2>
            <!-- Logout Form -->
			<a th:href="@{/logout}">Logout</a>
            <form th:action="@{/logout}" method="post" class="m-0">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn btn-danger btn-sm">Logout</button>
            </form>
        </div>
		
		<!-- Profile Image with Plus Icon -->
		       <div class="text-center mb-4">
		           <div class="profile-image-wrapper">
		               <img th:src="${profile.profileImageUrl}" alt="Profile Picture" class="profile-image" id="profilePreview"/>
		               <label for="imageFile" class="upload-icon">+</label>
		           </div>
		           <div>
		               <small class="text-muted">Click + to change profile picture</small>
		           </div>
		       </div>

        <!-- User Info -->
        <div class="mb-4">
            <h5 class="text-secondary">User Information</h5>
            <p><strong>Email:</strong> <span th:text="${user.email}"></span></p>
            <p><strong>Full Name:</strong> <span th:text="${user.fullName}"></span></p>
            <p><strong>Phone:</strong> <span th:text="${user.phone}"></span></p>
        </div>

        <!-- Profile Form -->
        <h5 class="text-secondary mb-3">Profile Details</h5>
        <form action="/profile/update" method="post" enctype="multipart/form-data" th:object="${profile}" class="row g-3">

            <!-- CSRF Token -->
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <input type="hidden" th:field="*{id}" />

            <!-- Hidden file input triggered by + icon -->
            <input type="file" name="imageFile" id="imageFile" class="d-none" accept="image/*" onchange="previewImage(event)" />

            <div class="col-12">
                <label class="form-label">Bio</label>
                <textarea class="form-control" rows="3" th:field="*{bio}" placeholder="Tell us something about yourself..."></textarea>
            </div>

            <div class="col-md-6">
                <label class="form-label">Date of Birth</label>
                <input type="date" class="form-control" th:field="*{dateOfBirth}" />
            </div>

            <div class="col-12 text-center mt-3">
                <button type="submit" class="btn btn-primary btn-custom">Update Profile</button>
            </div>
        </form>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Preview JS -->
<script>
    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = function(){
            document.getElementById('profilePreview').src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
</script>
</body>
</html>
